#!/usr/bin/env python3
"""Script to extract keys out of data.pcap """

from scapy.all import *

mapping = {
	0x0 : "", 0x01 : "MOD_LCTRL",0x02 : "MOD_LSHIFT",0x04 : "MOD_LALT",0x08 : "MOD_LMETA",0x10 : "MOD_RCTRL",0x20 : "MOD_RSHIFT",0x40 : "MOD_RALT",0x80 : "MOD_RMETA",0x00 : "NONE",0x01 : "ERR_OVF",0x04 : "A",0x05 : "B",0x06 : "C",0x07 : "D",0x08 : "E",0x09 : "F",0x0a : "G",0x0b : "H",0x0c : "I",0x0d : "J",0x0e : "K",0x0f : "L",0x10 : "M",0x11 : "N",0x12 : "O",0x13 : "P",0x14 : "Q",0x15 : "R",0x16 : "S",0x17 : "T",0x18 : "U",0x19 : "V",0x1a : "W",0x1b : "X",0x1c : "Y",0x1d : "Z",0x1e : "1",0x1f : "2",0x20 : "3",0x21 : "4",0x22 : "5",0x23 : "6",0x24 : "7",0x25 : "8",0x26 : "9",0x27 : "0",0x28 : "ENTER",0x29 : "ESC",0x2a : "BACKSPACE",0x2b : "TAB",0x2c : "SPACE",0x2d : "MINUS",0x2e : "EQUAL",0x2f : "LEFTBRACE",0x30 : "RIGHTBRACE",0x31 : "BACKSLASH",0x32 : "HASHTILDE",0x33 : "SEMICOLON",0x34 : "APOSTROPHE",0x35 : "GRAVE",0x36 : "COMMA",0x37 : "DOT",0x38 : "SLASH",0x39 : "CAPSLOCK",0x3a : "F1",0x3b : "F2",0x3c : "F3",0x3d : "F4",0x3e : "F5",0x3f : "F6",0x40 : "F7",0x41 : "F8",0x42 : "F9",0x43 : "F10",0x44 : "F11",0x45 : "F12",0x46 : "SYSRQ",0x47 : "SCROLLLOCK",0x48 : "PAUSE",0x49 : "INSERT",0x4a : "HOME",0x4b : "PAGEUP",0x4c : "DELETE",0x4d : "END",0x4e : "PAGEDOWN",0x4f : "RIGHT",0x50 : "LEFT",0x51 : "DOWN",0x52 : "UP",0x53 : "NUMLOCK",0x54 : "KPSLASH",0x55 : "KPASTERISK",0x56 : "KPMINUS",0x57 : "KPPLUS",0x58 : "KPENTER",0x59 : "KP1",0x5a : "KP2",0x5b : "KP3",0x5c : "KP4",0x5d : "KP5",0x5e : "KP6",0x5f : "KP7",0x60 : "KP8",0x61 : "KP9",0x62 : "KP0",0x63 : "KPDOT",0x64 : "102ND",0x65 : "COMPOSE",0x66 : "POWER",0x67 : "KPEQUAL",0x68 : "F13",0x69 : "F14",0x6a : "F15",0x6b : "F16",0x6c : "F17",0x6d : "F18",0x6e : "F19",0x6f : "F20",0x70 : "F21",0x71 : "F22",0x72 : "F23",0x73 : "F24",0x74 : "OPEN",0x75 : "HELP",0x76 : "PROPS",0x77 : "FRONT",0x78 : "STOP",0x79 : "AGAIN",0x7a : "UNDO",0x7b : "CUT",0x7c : "COPY",0x7d : "PASTE",0x7e : "FIND",0x7f : "MUTE",0x80 : "VOLUMEUP",0x81 : "VOLUMEDOWN",0x85 : "KPCOMMA",0x87 : "RO",0x88 : "KATAKANAHIRAGANA",0x89 : "YEN",0x8a : "HENKAN",0x8b : "MUHENKAN",0x8c : "KPJPCOMMA",0x90 : "HANGEUL",0x91 : "HANJA",0x92 : "KATAKANA",0x93 : "HIRAGANA",0x94 : "ZENKAKUHANKAKU",0xb6 : "KPLEFTPAREN",0xb7 : "KPRIGHTPAREN",0xe0 : "LEFTCTRL",0xe1 : "LEFTSHIFT",0xe2 : "LEFTALT",0xe3 : "LEFTMETA",0xe4 : "RIGHTCTRL",0xe5 : "RIGHTSHIFT",0xe6 : "RIGHTALT",0xe7 : "RIGHTMETA",0xe8 : "MEDIA_PLAYPAUSE",0xe9 : "MEDIA_STOPCD",0xea : "MEDIA_PREVIOUSSONG",0xeb : "MEDIA_NEXTSONG",0xec : "MEDIA_EJECTCD",0xed : "MEDIA_VOLUMEUP",0xee : "MEDIA_VOLUMEDOWN",0xef : "MEDIA_MUTE",0xf0 : "MEDIA_WWW",0xf1 : "MEDIA_BACK",0xf2 : "MEDIA_FORWARD",0xf3 : "MEDIA_STOP",0xf4 : "MEDIA_FIND",0xf5 : "MEDIA_SCROLLUP",0xf6 : "MEDIA_SCROLLDOWN",0xf7 : "MEDIA_EDIT",0xf8 : "MEDIA_SLEEP",0xf9 : "MEDIA_COFFEE",0xfa : "MEDIA_REFRESH",0xfb : "MEDIA_CALC",
}

packets = rdpcap('deadly_arthropod.pcap')
for each_packet in packets:
	special_byte = each_packet[0].load[-6]
	print(mapping[special_byte])
